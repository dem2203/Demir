<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEMIR AI v8.0 PRO - Profesyonel Trader Dashboard</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        /* ... [All CSS remains exactly the same] ... */
    </style>
</head>
<body>
    <!-- ... [All HTML remains exactly the same until the Turkish comment generation function] ... -->
    
    <script>
    // ================================================================
    // DEMIR AI v8.0 PRO - TÃœRKÃ‡E TRADER DASHBOARD
    // ================================================================
    
    const API_URL = window.location.origin;
    let socket = null;
    let performanceChart = null;
    
    // BAÅLATMA
    document.addEventListener('DOMContentLoaded', () => {
        initializeConnection();
        startClock();
        initializeChart();
        setInterval(fetchLayerData, 5000); // Her 5 saniyede layer verileri Ã§ek
        setInterval(fetchSignals, 3000); // Her 3 saniyede sinyal Ã§ek
    });
    
    // SAAT
    function startClock() {
        setInterval(() => {
            const now = new Date();
            document.getElementById('time').textContent = now.toLocaleTimeString('tr-TR');
        }, 1000);
    }
    
    // BAÄLANTI
    function initializeConnection() {
        try {
            socket = io(API_URL);
            
            socket.on('connect', () => {
                document.getElementById('status-text').textContent = 'BaÄŸlÄ± - Aktif';
                document.querySelector('.status-dot').style.background = 'var(--green)';
            });
            
            socket.on('disconnect', () => {
                document.getElementById('status-text').textContent = 'BaÄŸlantÄ± Kesildi';
                document.querySelector('.status-dot').style.background = 'var(--red)';
            });
            
            socket.on('signal', (data) => {
                updateAIComment(data);
                addSignalToList(data);
            });
            
            socket.on('layers', (data) => {
                updateLayerAnalysis(data);
            });
            
        } catch (error) {
            console.error('Socket baÄŸlantÄ± hatasÄ±:', error);
            document.getElementById('status-text').textContent = 'BaÄŸlantÄ± HatasÄ±';
        }
    }
    
    // AI YORUM GÃœNCELLE
    function updateAIComment(data) {
        if (!data || !data.consensus) return;
        
        const consensus = data.consensus;
        const direction = consensus.direction || 'NEUTRAL';
        const strength = (consensus.weighted_strength * 100).toFixed(1);
        const confidence = (consensus.consensus_confidence * 100).toFixed(1);
        
        // Sinyal yÃ¶nÃ¼
        const dirElement = document.getElementById('ai-direction');
        dirElement.textContent = direction === 'LONG' ? 'ALIÅ' : direction === 'SHORT' ? 'SATIÅ' : 'NÃ–TR';
        dirElement.className = `signal-direction signal-${direction.toLowerCase()}`;
        
        // Ä°statistikler
        document.getElementById('ai-strength').textContent = `${strength}%`;
        document.getElementById('ai-confidence').textContent = `${confidence}%`;
        document.getElementById('ai-rr').textContent = data.risk_reward ? data.risk_reward.toFixed(2) : '--';
        
        // Grup sayÄ±sÄ±
        const groups = consensus.groups || {};
        const agreeing = Object.values(groups).filter(g => g.direction === direction).length;
        document.getElementById('ai-groups').textContent = `${agreeing}/5`;
        
        // TÃœRKÃ‡E YORUM OLUÅTUR
        const reasoning = generateTurkishReasoning(data);
        document.getElementById('ai-reasoning').textContent = reasoning;
        
        // Destekleyen/KarÅŸÄ± gruplarÄ± gÃ¶ster
        updateGroupSignals(groups, direction);
    }
    
    // TÃœRKÃ‡E YORUM OLUÅTUR
    function generateTurkishReasoning(data) {
        const consensus = data.consensus;
        const direction = consensus.direction;
        const strength = (consensus.weighted_strength * 100).toFixed(1);
        const confidence = (consensus.consensus_confidence * 100).toFixed(1);
        const symbol = data.symbol || 'BTCUSDT';
        
        let reasoning = `ğŸ“Š ${symbol} Ä°Ã‡Ä°N DETAYLI ANALÄ°Z:\n\n`;
        
        // Genel durum
        if (direction === 'LONG') {
            reasoning += `âœ… ALIÅ SÄ°NYALÄ° tespit edildi. Piyasa ${strength}% gÃ¼Ã§ ile YUKARI yÃ¶nlÃ¼ hareket gÃ¶steriyor.\n\n`;
        } else if (direction === 'SHORT') {
            reasoning += `ğŸ”» SATIÅ SÄ°NYALÄ° tespit edildi. Piyasa ${strength}% gÃ¼Ã§ ile AÅAÄI yÃ¶nlÃ¼ baskÄ± altÄ±nda.\n\n`;
        } else {
            reasoning += `âš ï¸ NÃ–TR DURUM. Piyasada net bir yÃ¶n belirlenmedi. Beklemek en iyi strateji.\n\n`;
        }
        
        // GÃ¼ven seviyesi yorumu
        reasoning += `ğŸ¯ GÃ¼ven Seviyesi: ${confidence}%\n`;
        if (confidence >= 75) {
            reasoning += `   â†’ Ã‡ok yÃ¼ksek gÃ¼ven! TÃ¼m AI katmanlarÄ± uyumlu Ã§alÄ±ÅŸÄ±yor.\n`;
        } else if (confidence >= 60) {
            reasoning += `   â†’ Ä°yi seviye. Ã‡oÄŸu katman aynÄ± yÃ¶nde sinyal veriyor.\n`;
        } else {
            reasoning += `   â†’ DÃ¼ÅŸÃ¼k gÃ¼ven. Katmanlar arasÄ±nda uyumsuzluk var, dikkatli olun.\n`;
        }
        reasoning += `\n`;
        
        // Grup analizi
        const groups = consensus.groups || {};
        reasoning += `ğŸ“ˆ GRUP ANALÄ°ZÄ°:\n`;
        
        if (groups.technical) {
            const tech = groups.technical;
            reasoning += `   â€¢ Technical (19 gÃ¶sterge): ${(tech.strength * 100).toFixed(0)}% ${tech.direction}\n`;
        }
        if (groups.sentiment) {
            const sent = groups.sentiment;
            reasoning += `   â€¢ Sentiment (15 kaynak): ${(sent.strength * 100).toFixed(0)}% ${sent.direction}\n`;
        }
        if (groups.ml) {
            const ml = groups.ml;
            reasoning += `   â€¢ ML Models (5 model): ${(ml.strength * 100).toFixed(0)}% ${ml.direction}\n`;
        }
        if (groups.onchain) {
            const chain = groups.onchain;
            reasoning += `   â€¢ On-Chain (4 metrik): ${(chain.strength * 100).toFixed(0)}% ${chain.direction}\n`;
        }
        if (groups.risk) {
            const risk = groups.risk;
            reasoning += `   â€¢ Risk (5 model): ${(risk.strength * 100).toFixed(0)}% ${risk.direction}\n`;
        }
        reasoning += `\n`;
        
        // Ã–neri
        reasoning += `ğŸ’¡ TAVSÄ°YE:\n`;
        if (direction === 'LONG' && confidence >= 70) {
            reasoning += `   âœ… GÃ¼Ã§lÃ¼ ALIÅ fÄ±rsatÄ±. Stop loss: ${data.stop_loss || 'N/A'}, Hedef: ${data.take_profit || 'N/A'}\n`;
            reasoning += `   âœ… Pozisyon boyutu: Kelly criterion'a gÃ¶re %${data.position_size || '2.5'} Ã¶neriliyor.\n`;
        } else if (direction === 'SHORT' && confidence >= 70) {
            reasoning += `   ğŸ”» GÃ¼Ã§lÃ¼ SATIÅ fÄ±rsatÄ±. Stop loss: ${data.stop_loss || 'N/A'}, Hedef: ${data.take_profit || 'N/A'}\n`;
            reasoning += `   ğŸ”» KÄ±sa pozisyon al, risk yÃ¶netimine Ã¶zen gÃ¶ster.\n`;
        } else {
            reasoning += `   âš ï¸ Bekle ve gÃ¶zle. Daha net sinyaller iÃ§in gÃ¼ven seviyesi %70+ olmalÄ±.\n`;
            reasoning += `   âš ï¸ Åu an piyasaya girmek riskli, saburlÄ± ol.\n`;
        }
        
        reasoning += `\nâ° Analiz ZamanÄ±: ${new Date().toLocaleString('tr-TR')}`;
        
        return reasoning;
    }
    
    /* ... [Rest of JavaScript remains exactly the same] ... */
    
    </script>
</body>
</html>